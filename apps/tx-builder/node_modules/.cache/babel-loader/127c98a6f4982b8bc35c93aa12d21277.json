{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, privateMap, value) {\n  if (!privateMap.has(receiver)) {\n    throw new TypeError(\"attempted to set private field on non-instance\");\n  }\n\n  privateMap.set(receiver, value);\n  return value;\n};\n\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, privateMap) {\n  if (!privateMap.has(receiver)) {\n    throw new TypeError(\"attempted to get private field on non-instance\");\n  }\n\n  return privateMap.get(receiver);\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nvar _communicator;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst communication_1 = require(\"./communication\");\n\nconst communication_2 = __importDefault(require(\"./communication\"));\n\nconst txs_1 = require(\"./txs\");\n\nconst eth_1 = require(\"./eth\");\n\nclass SafeAppsSDK {\n  constructor(opts = {}) {\n    _communicator.set(this, void 0);\n\n    if (typeof window === 'undefined') {\n      throw new Error('Error initializing the sdk: window is undefined');\n    }\n\n    const {\n      whitelistedDomains = null\n    } = opts;\n\n    __classPrivateFieldSet(this, _communicator, new communication_2.default(whitelistedDomains));\n\n    this.eth = new eth_1.Eth(__classPrivateFieldGet(this, _communicator));\n    this.txs = new txs_1.TXs(__classPrivateFieldGet(this, _communicator));\n    this.bootstrap();\n  }\n\n  bootstrap() {\n    return __awaiter(this, void 0, void 0, function* () {\n      const {\n        txServiceUrl\n      } = yield this.getEnvInfo();\n      this.txs.setTxServiceUrl(txServiceUrl);\n    });\n  }\n\n  getEnvInfo() {\n    return __awaiter(this, void 0, void 0, function* () {\n      const response = yield __classPrivateFieldGet(this, _communicator).send(communication_1.METHODS.getEnvInfo, undefined);\n\n      if (!response.success) {\n        throw new Error(response.error);\n      }\n\n      return response.data;\n    });\n  }\n\n  getSafeInfo() {\n    return __awaiter(this, void 0, void 0, function* () {\n      const response = yield __classPrivateFieldGet(this, _communicator).send(communication_1.METHODS.getSafeInfo, undefined);\n\n      if (!response.success) {\n        throw new Error(response.error);\n      }\n\n      return response.data;\n    });\n  }\n\n}\n\n_communicator = new WeakMap();\nexports.default = SafeAppsSDK;","map":{"version":3,"sources":["../../src/sdk.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAA,eAAA,GAAA,OAAA,CAAA,iBAAA,CAAA;;AAEA,MAAA,eAAA,GAAA,eAAA,CAAA,OAAA,CAAA,iBAAA,CAAA,CAAA;;AACA,MAAA,KAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AACA,MAAA,KAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AAMA,MAAM,WAAN,CAAiB;AAKf,EAAA,WAAA,CAAY,IAAA,GAAa,EAAzB,EAA2B;AAJ3B,IAAA,aAAA,CAAA,GAAA,CAAA,IAAA,EAAA,KAAA,CAAA;;AAKE,QAAI,OAAO,MAAP,KAAkB,WAAtB,EAAmC;AACjC,YAAM,IAAI,KAAJ,CAAU,iDAAV,CAAN;AACD;;AAED,UAAM;AAAE,MAAA,kBAAkB,GAAG;AAAvB,QAAgC,IAAtC;;AAEA,IAAA,sBAAA,CAAA,IAAA,EAAI,aAAJ,EAAqB,IAAI,eAAA,CAAA,OAAJ,CAA0B,kBAA1B,CAArB,CAAA;;AACA,SAAK,GAAL,GAAW,IAAI,KAAA,CAAA,GAAJ,CAAO,sBAAA,CAAA,IAAA,EAAA,aAAA,CAAP,CAAX;AACA,SAAK,GAAL,GAAW,IAAI,KAAA,CAAA,GAAJ,CAAO,sBAAA,CAAA,IAAA,EAAA,aAAA,CAAP,CAAX;AACA,SAAK,SAAL;AACD;;AAEa,EAAA,SAAS,GAAA;;AACrB,YAAM;AAAE,QAAA;AAAF,UAAmB,MAAM,KAAK,UAAL,EAA/B;AAEA,WAAK,GAAL,CAAS,eAAT,CAAyB,YAAzB;AACD,K;AAAA;;AAEa,EAAA,UAAU,GAAA;;AACtB,YAAM,QAAQ,GAAG,MAAM,sBAAA,CAAA,IAAA,EAAA,aAAA,CAAA,CAAmB,IAAnB,CAA0D,eAAA,CAAA,OAAA,CAAQ,UAAlE,EAA8E,SAA9E,CAAvB;;AAEA,UAAI,CAAC,QAAQ,CAAC,OAAd,EAAuB;AACrB,cAAM,IAAI,KAAJ,CAAU,QAAQ,CAAC,KAAnB,CAAN;AACD;;AAED,aAAO,QAAQ,CAAC,IAAhB;AACD,K;AAAA;;AAEK,EAAA,WAAW,GAAA;;AACf,YAAM,QAAQ,GAAG,MAAM,sBAAA,CAAA,IAAA,EAAA,aAAA,CAAA,CAAmB,IAAnB,CAA4D,eAAA,CAAA,OAAA,CAAQ,WAApE,EAAiF,SAAjF,CAAvB;;AAEA,UAAI,CAAC,QAAQ,CAAC,OAAd,EAAuB;AACrB,cAAM,IAAI,KAAJ,CAAU,QAAQ,CAAC,KAAnB,CAAN;AACD;;AAED,aAAO,QAAQ,CAAC,IAAhB;AACD,K;AAAA;;AA1Cc;;;AA6CjB,OAAA,CAAA,OAAA,GAAe,WAAf","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to set private field on non-instance\");\n    }\n    privateMap.set(receiver, value);\n    return value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to get private field on non-instance\");\n    }\n    return privateMap.get(receiver);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar _communicator;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst communication_1 = require(\"./communication\");\nconst communication_2 = __importDefault(require(\"./communication\"));\nconst txs_1 = require(\"./txs\");\nconst eth_1 = require(\"./eth\");\nclass SafeAppsSDK {\n    constructor(opts = {}) {\n        _communicator.set(this, void 0);\n        if (typeof window === 'undefined') {\n            throw new Error('Error initializing the sdk: window is undefined');\n        }\n        const { whitelistedDomains = null } = opts;\n        __classPrivateFieldSet(this, _communicator, new communication_2.default(whitelistedDomains));\n        this.eth = new eth_1.Eth(__classPrivateFieldGet(this, _communicator));\n        this.txs = new txs_1.TXs(__classPrivateFieldGet(this, _communicator));\n        this.bootstrap();\n    }\n    bootstrap() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { txServiceUrl } = yield this.getEnvInfo();\n            this.txs.setTxServiceUrl(txServiceUrl);\n        });\n    }\n    getEnvInfo() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const response = yield __classPrivateFieldGet(this, _communicator).send(communication_1.METHODS.getEnvInfo, undefined);\n            if (!response.success) {\n                throw new Error(response.error);\n            }\n            return response.data;\n        });\n    }\n    getSafeInfo() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const response = yield __classPrivateFieldGet(this, _communicator).send(communication_1.METHODS.getSafeInfo, undefined);\n            if (!response.success) {\n                throw new Error(response.error);\n            }\n            return response.data;\n        });\n    }\n}\n_communicator = new WeakMap();\nexports.default = SafeAppsSDK;\n//# sourceMappingURL=sdk.js.map"]},"metadata":{},"sourceType":"script"}